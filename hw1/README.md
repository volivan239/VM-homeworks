# Определение характеристик кэша

### Запуск
Предполагается ручная компиляция и запуск:
```
g++ -std=c++17 -O0 -o main main.cpp
./main
```

Запуск может занять несколько секунд.
Длина кэшлинии на некоторых архитектурах может вычисляться не очень стабильно :(

### Метод поиска характеристик
Для поиска размера и ассоциативности кэша использовался алгоритм на основе статьи "Robust Method to Determine Cache and TLB Characteristics".

Для вычисления длины линии я перебирал эту самую длину `len` и разбивал память размером `2 * CACHE_SIZE` на отрезки длины `len`, после чего выбирал из них каждый второй, чередуя выбранные и невыбранные.
При этом если в первой половине участка памяти (т.е. в первых `CACHE_SIZE` байт) отрезок выбран, то во второй отрезок с тем же номером не выбран, и наоборот.
При таком разбиении если `len` больше либо равно истинной длине кэшлинии, то все удачно помещается в кэш, а если `len` меньше длины кэшлинии, то число выбранных отрезков больше числа линеек кэша, и все они в кэш не поместятся, и времени на проход по ним будет тратиться больше.
Это наблюдение и позволит определить длину линии.